import{r as t,g as e}from"./p-dcd71f28.js";import{d as o,c as s,i}from"./p-a937deb3.js";import{u as a}from"./p-78249524.js";import{u as n}from"./p-01fcf2fe.js";import{u as r}from"./p-eed2553d.js";import{u as c,b as h}from"./p-4256f181.js";function d(t,e){const{type:s,separator:i}=t,{top:a,shadow:d,frame:u,mode:f,dispatch:w,state:v}=e,l=n(v);t.path=t.path||"";const j=c.set(t,l,f,a),b=JSON.parse(localStorage.getItem("uniStoreDebug"));b&&b[s]&&b[s].includes("set")&&function(t,e,o){console.log("%cSTORE SET:","color: darkred; font-weight: bold",Object.assign(Object.assign(Object.assign({},t),e),{value:o,$event:void 0}))}(t,e,j),setTimeout((()=>{const e=r({top:a,shadow:d,frame:u,selector:w});m(a,e,t,l),o(l)&&p(a,e,h(t),i,l)}))}function m(t,e,o,s){const i=h(o);e.forEach((t=>{t.dispatchEvent(new CustomEvent(i,{detail:s}))})),(t?window.top:window).document.body.dispatchEvent(new CustomEvent(i,{detail:s}));const a=Object.assign({},o),n=o.path.split(o.separator),r=n.pop();n.length>0&&(r.includes("[")&&n.push(r.split("[")[0]),a.path=n.join(o.separator),m(t,e,a,c.get(a,t)))}function p(t,e,o,s,i){for(let[a,n]of Object.entries(i))u(t,e,o+s+a,s,n)}function u(t,e,i,a,n){o(n)?p(t,e,i,a,n):s(n)&&function(t,e,o,s,i){i.forEach(((i,a)=>{u(t,e,`${o}[${a}]`,s,i)}))}(t,e,i,a,n),e.forEach((t=>{t.dispatchEvent(new CustomEvent(i,{detail:n}))})),(t?window.top:window).document.body.dispatchEvent(new CustomEvent(i,{detail:n}))}const f=class{constructor(e){t(this,e),this.inactive=!1,this.activate=!1,this.top=!1,this.shadow=!1,this.frame=!1,this.mode="merge",this.type="memory",this.feature="uni.store",this.separator=".",this.dispatch="uni-event, uni-event-shadow"}onChange(){const{top:t,shadow:e,frame:o,mode:s,type:a,feature:n,separator:r,path:c,state:h,dispatch:m}=this,p={type:a,feature:n,separator:r,path:c},u={top:t,shadow:e,frame:o,mode:s,state:h,dispatch:m};this.inactive&&!this.activate||(i(this.state)&&d(p,u),setTimeout((()=>this.activate=!1)))}onActivate(){this.onChange()}onInactive(){this.onChange()}onState(){this.onChange()}componentDidLoad(){a("uni-store-set","bottom"),this.onChange()}get el(){return e(this)}static get watchers(){return{activate:["onActivate"],inactive:["onInactive"],state:["onState"]}}};export{f as U}